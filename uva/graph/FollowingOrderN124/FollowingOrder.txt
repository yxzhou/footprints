It's topological sort

Input:
a b
a b
a b
b a
a b c
b c a c
a b c
a b a c
a b f g
a b b f
v w x y z
v y x v z v w v
z a b c d e
a b c d z a a e
a b c d
a c b d
d c a b
a d d b
p o q a b c d e r
p o q a b c d e r e d p a o r q r c r b

Output:
ab

ba

abc
bac

abc
acb

abfg
abgf
agbf
gabf

wxzvy
wzxvy
xwzvy
xzwvy
zwxvy
zxwvy

cdzabe
cdzaeb
czabde
czabed
czadbe
czadeb
czaebd
czaedb
czdabe
czdaeb
zabcde
zabced
zabecd
zacbde
zacbed
zacdbe
zacdeb
zacebd
zacedb
zaebcd
zaecbd
zaecdb
zcabde
zcabed
zcadbe
zcadeb
zcaebd
zcaedb
zcdabe
zcdaeb

abcd
abdc
acbd
bacd
badc
bdac

acdb
adbc
adcb
cadb

dprbceqao
dprbcqaeo
dprbcqaoe
dprbcqeao
dprbecqao
dprbeqaco
dprbeqaoc
dprbeqcao
dprbqaceo
dprbqacoe
dprbqaeco
dprbqaeoc
dprbqaoce
dprbqaoec
dprbqcaeo
dprbqcaoe
dprbqceao
dprbqeaco
dprbqeaoc
dprbqecao
dprebcqao
dprebqaco
dprebqaoc
dprebqcao
dpreqabco
dpreqaboc
dpreqaobc
dpreqbaco
dpreqbaoc
dpreqbcao
dprqabceo
dprqabcoe
dprqabeco
dprqabeoc
dprqaboce
dprqaboec
dprqaebco
dprqaeboc
dprqaeobc
dprqaobce
dprqaobec
dprqaoebc
dprqbaceo
dprqbacoe
dprqbaeco
dprqbaeoc
dprqbaoce
dprqbaoec
dprqbcaeo
dprqbcaoe
dprqbceao
dprqbeaco
dprqbeaoc
dprqbecao
dprqeabco
dprqeaboc
dprqeaobc
dprqebaco
dprqebaoc
dprqebcao
drbcepqao
drbceqapo
drbceqpao
drbcpeqao
drbcpqaeo
drbcpqaoe
drbcpqeao
drbcqaepo
drbcqapeo
drbcqapoe
drbcqeapo
drbcqepao
drbcqpaeo
drbcqpaoe
drbcqpeao
drbecpqao
drbecqapo
drbecqpao
drbepcqao
drbepqaco
drbepqaoc
drbepqcao
drbeqacpo
drbeqapco
drbeqapoc
drbeqcapo
drbeqcpao
drbeqpaco
drbeqpaoc
drbeqpcao
drbpceqao
drbpcqaeo
drbpcqaoe
drbpcqeao
drbpecqao
drbpeqaco
drbpeqaoc
drbpeqcao
drbpqaceo
drbpqacoe
drbpqaeco
drbpqaeoc
drbpqaoce
drbpqaoec
drbpqcaeo
drbpqcaoe
drbpqceao
drbpqeaco
drbpqeaoc
drbpqecao
drbqacepo
drbqacpeo
drbqacpoe
drbqaecpo
drbqaepco
drbqaepoc
drbqapceo
drbqapcoe
drbqapeco
drbqapeoc
drbqapoce
drbqapoec
drbqcaepo
drbqcapeo
drbqcapoe
drbqceapo
drbqcepao
drbqcpaeo
drbqcpaoe
drbqcpeao
drbqeacpo
drbqeapco
drbqeapoc
drbqecapo
drbqecpao
drbqepaco
drbqepaoc
drbqepcao
drbqpaceo
drbqpacoe
drbqpaeco
drbqpaeoc
drbqpaoce
drbqpaoec
drbqpcaeo
drbqpcaoe
drbqpceao
drbqpeaco
drbqpeaoc
drbqpecao
drebcpqao
drebcqapo
drebcqpao
drebpcqao
drebpqaco
drebpqaoc
drebpqcao
drebqacpo
drebqapco
drebqapoc
drebqcapo
drebqcpao
drebqpaco
drebqpaoc
drebqpcao
drepbcqao
drepbqaco
drepbqaoc
drepbqcao
drepqabco
drepqaboc
drepqaobc
drepqbaco
drepqbaoc
drepqbcao
dreqabcpo
dreqabpco
dreqabpoc
dreqapbco
dreqapboc
dreqapobc
dreqbacpo
dreqbapco
dreqbapoc
dreqbcapo
dreqbcpao
dreqbpaco
dreqbpaoc
dreqbpcao
dreqpabco
dreqpaboc
dreqpaobc
dreqpbaco
dreqpbaoc
dreqpbcao
drpbceqao
drpbcqaeo
drpbcqaoe
drpbcqeao
drpbecqao
drpbeqaco
drpbeqaoc
drpbeqcao
drpbqaceo
drpbqacoe
drpbqaeco
drpbqaeoc
drpbqaoce
drpbqaoec
drpbqcaeo
drpbqcaoe
drpbqceao
drpbqeaco
drpbqeaoc
drpbqecao
drpebcqao
drpebqaco
drpebqaoc
drpebqcao
drpeqabco
drpeqaboc
drpeqaobc
drpeqbaco
drpeqbaoc
drpeqbcao
drpqabceo
drpqabcoe
drpqabeco
drpqabeoc
drpqaboce
drpqaboec
drpqaebco
drpqaeboc
drpqaeobc
drpqaobce
drpqaobec
drpqaoebc
drpqbaceo
drpqbacoe
drpqbaeco
drpqbaeoc
drpqbaoce
drpqbaoec
drpqbcaeo
drpqbcaoe
drpqbceao
drpqbeaco
drpqbeaoc
drpqbecao
drpqeabco
drpqeaboc
drpqeaobc
drpqebaco
drpqebaoc
drpqebcao
drqabcepo
drqabcpeo
drqabcpoe
drqabecpo
drqabepco
drqabepoc
drqabpceo
drqabpcoe
drqabpeco
drqabpeoc
drqabpoce
drqabpoec
drqaebcpo
drqaebpco
drqaebpoc
drqaepbco
drqaepboc
drqaepobc
drqapbceo
drqapbcoe
drqapbeco
drqapbeoc
drqapboce
drqapboec
drqapebco
drqapeboc
drqapeobc
drqapobce
drqapobec
drqapoebc
drqbacepo
drqbacpeo
drqbacpoe
drqbaecpo
drqbaepco
drqbaepoc
drqbapceo
drqbapcoe
drqbapeco
drqbapeoc
drqbapoce
drqbapoec
drqbcaepo
drqbcapeo
drqbcapoe
drqbceapo
drqbcepao
drqbcpaeo
drqbcpaoe
drqbcpeao
drqbeacpo
drqbeapco
drqbeapoc
drqbecapo
drqbecpao
drqbepaco
drqbepaoc
drqbepcao
drqbpaceo
drqbpacoe
drqbpaeco
drqbpaeoc
drqbpaoce
drqbpaoec
drqbpcaeo
drqbpcaoe
drqbpceao
drqbpeaco
drqbpeaoc
drqbpecao
drqeabcpo
drqeabpco
drqeabpoc
drqeapbco
drqeapboc
drqeapobc
drqebacpo
drqebapco
drqebapoc
drqebcapo
drqebcpao
drqebpaco
drqebpaoc
drqebpcao
drqepabco
drqepaboc
drqepaobc
drqepbaco
drqepbaoc
drqepbcao
drqpabceo
drqpabcoe
drqpabeco
drqpabeoc
drqpaboce
drqpaboec
drqpaebco
drqpaeboc
drqpaeobc
drqpaobce
drqpaobec
drqpaoebc
drqpbaceo
drqpbacoe
drqpbaeco
drqpbaeoc
drqpbaoce
drqpbaoec
drqpbcaeo
drqpbcaoe
drqpbceao
drqpbeaco
drqpbeaoc
drqpbecao
drqpeabco
drqpeaboc
drqpeaobc
drqpebaco
drqpebaoc
drqpebcao
rbcdepqao
rbcdeqapo
rbcdeqpao
rbcdpeqao
rbcdpqaeo
rbcdpqaoe
rbcdpqeao
rbcdqaepo
rbcdqapeo
rbcdqapoe
rbcdqeapo
rbcdqepao
rbcdqpaeo
rbcdqpaoe
rbcdqpeao
rbcqadepo
rbcqadpeo
rbcqadpoe
rbcqdaepo
rbcqdapeo
rbcqdapoe
rbcqdeapo
rbcqdepao
rbcqdpaeo
rbcqdpaoe
rbcqdpeao
rbdcepqao
rbdceqapo
rbdceqpao
rbdcpeqao
rbdcpqaeo
rbdcpqaoe
rbdcpqeao
rbdcqaepo
rbdcqapeo
rbdcqapoe
rbdcqeapo
rbdcqepao
rbdcqpaeo
rbdcqpaoe
rbdcqpeao
rbdecpqao
rbdecqapo
rbdecqpao
rbdepcqao
rbdepqaco
rbdepqaoc
rbdepqcao
rbdeqacpo
rbdeqapco
rbdeqapoc
rbdeqcapo
rbdeqcpao
rbdeqpaco
rbdeqpaoc
rbdeqpcao
rbdpceqao
rbdpcqaeo
rbdpcqaoe
rbdpcqeao
rbdpecqao
rbdpeqaco
rbdpeqaoc
rbdpeqcao
rbdpqaceo
rbdpqacoe
rbdpqaeco
rbdpqaeoc
rbdpqaoce
rbdpqaoec
rbdpqcaeo
rbdpqcaoe
rbdpqceao
rbdpqeaco
rbdpqeaoc
rbdpqecao
rbdqacepo
rbdqacpeo
rbdqacpoe
rbdqaecpo
rbdqaepco
rbdqaepoc
rbdqapceo
rbdqapcoe
rbdqapeco
rbdqapeoc
rbdqapoce
rbdqapoec
rbdqcaepo
rbdqcapeo
rbdqcapoe
rbdqceapo
rbdqcepao
rbdqcpaeo
rbdqcpaoe
rbdqcpeao
rbdqeacpo
rbdqeapco
rbdqeapoc
rbdqecapo
rbdqecpao
rbdqepaco
rbdqepaoc
rbdqepcao
rbdqpaceo
rbdqpacoe
rbdqpaeco
rbdqpaeoc
rbdqpaoce
rbdqpaoec
rbdqpcaeo
rbdqpcaoe
rbdqpceao
rbdqpeaco
rbdqpeaoc
rbdqpecao
rbqacdepo
rbqacdpeo
rbqacdpoe
rbqadcepo
rbqadcpeo
rbqadcpoe
rbqadecpo
rbqadepco
rbqadepoc
rbqadpceo
rbqadpcoe
rbqadpeco
rbqadpeoc
rbqadpoce
rbqadpoec
rbqcadepo
rbqcadpeo
rbqcadpoe
rbqcdaepo
rbqcdapeo
rbqcdapoe
rbqcdeapo
rbqcdepao
rbqcdpaeo
rbqcdpaoe
rbqcdpeao
rbqdacepo
rbqdacpeo
rbqdacpoe
rbqdaecpo
rbqdaepco
rbqdaepoc
rbqdapceo
rbqdapcoe
rbqdapeco
rbqdapeoc
rbqdapoce
rbqdapoec
rbqdcaepo
rbqdcapeo
rbqdcapoe
rbqdceapo
rbqdcepao
rbqdcpaeo
rbqdcpaoe
rbqdcpeao
rbqdeacpo
rbqdeapco
rbqdeapoc
rbqdecapo
rbqdecpao
rbqdepaco
rbqdepaoc
rbqdepcao
rbqdpaceo
rbqdpacoe
rbqdpaeco
rbqdpaeoc
rbqdpaoce
rbqdpaoec
rbqdpcaeo
rbqdpcaoe
rbqdpceao
rbqdpeaco
rbqdpeaoc
rbqdpecao
rdbcepqao
rdbceqapo
rdbceqpao
rdbcpeqao
rdbcpqaeo
rdbcpqaoe
rdbcpqeao
rdbcqaepo
rdbcqapeo
rdbcqapoe
rdbcqeapo
rdbcqepao
rdbcqpaeo
rdbcqpaoe
rdbcqpeao
rdbecpqao
rdbecqapo
rdbecqpao
rdbepcqao
rdbepqaco
rdbepqaoc
rdbepqcao
rdbeqacpo
rdbeqapco
rdbeqapoc
rdbeqcapo
rdbeqcpao
rdbeqpaco
rdbeqpaoc
rdbeqpcao
rdbpceqao
rdbpcqaeo
rdbpcqaoe
rdbpcqeao
rdbpecqao
rdbpeqaco
rdbpeqaoc
rdbpeqcao
rdbpqaceo
rdbpqacoe
rdbpqaeco
rdbpqaeoc
rdbpqaoce
rdbpqaoec
rdbpqcaeo
rdbpqcaoe
rdbpqceao
rdbpqeaco
rdbpqeaoc
rdbpqecao
rdbqacepo
rdbqacpeo
rdbqacpoe
rdbqaecpo
rdbqaepco
rdbqaepoc
rdbqapceo
rdbqapcoe
rdbqapeco
rdbqapeoc
rdbqapoce
rdbqapoec
rdbqcaepo
rdbqcapeo
rdbqcapoe
rdbqceapo
rdbqcepao
rdbqcpaeo
rdbqcpaoe
rdbqcpeao
rdbqeacpo
rdbqeapco
rdbqeapoc
rdbqecapo
rdbqecpao
rdbqepaco
rdbqepaoc
rdbqepcao
rdbqpaceo
rdbqpacoe
rdbqpaeco
rdbqpaeoc
rdbqpaoce
rdbqpaoec
rdbqpcaeo
rdbqpcaoe
rdbqpceao
rdbqpeaco
rdbqpeaoc
rdbqpecao
rdebcpqao
rdebcqapo
rdebcqpao
rdebpcqao
rdebpqaco
rdebpqaoc
rdebpqcao
rdebqacpo
rdebqapco
rdebqapoc
rdebqcapo
rdebqcpao
rdebqpaco
rdebqpaoc
rdebqpcao
rdepbcqao
rdepbqaco
rdepbqaoc
rdepbqcao
rdepqabco
rdepqaboc
rdepqaobc
rdepqbaco
rdepqbaoc
rdepqbcao
rdeqabcpo
rdeqabpco
rdeqabpoc
rdeqapbco
rdeqapboc
rdeqapobc
rdeqbacpo
rdeqbapco
rdeqbapoc
rdeqbcapo
rdeqbcpao
rdeqbpaco
rdeqbpaoc
rdeqbpcao
rdeqpabco
rdeqpaboc
rdeqpaobc
rdeqpbaco
rdeqpbaoc
rdeqpbcao
rdpbceqao
rdpbcqaeo
rdpbcqaoe
rdpbcqeao
rdpbecqao
rdpbeqaco
rdpbeqaoc
rdpbeqcao
rdpbqaceo
rdpbqacoe
rdpbqaeco
rdpbqaeoc
rdpbqaoce
rdpbqaoec
rdpbqcaeo
rdpbqcaoe
rdpbqceao
rdpbqeaco
rdpbqeaoc
rdpbqecao
rdpebcqao
rdpebqaco
rdpebqaoc
rdpebqcao
rdpeqabco
rdpeqaboc
rdpeqaobc
rdpeqbaco
rdpeqbaoc
rdpeqbcao
rdpqabceo
rdpqabcoe
rdpqabeco
rdpqabeoc
rdpqaboce
rdpqaboec
rdpqaebco
rdpqaeboc
rdpqaeobc
rdpqaobce
rdpqaobec
rdpqaoebc
rdpqbaceo
rdpqbacoe
rdpqbaeco
rdpqbaeoc
rdpqbaoce
rdpqbaoec
rdpqbcaeo
rdpqbcaoe
rdpqbceao
rdpqbeaco
rdpqbeaoc
rdpqbecao
rdpqeabco
rdpqeaboc
rdpqeaobc
rdpqebaco
rdpqebaoc
rdpqebcao
rdqabcepo
rdqabcpeo
rdqabcpoe
rdqabecpo
rdqabepco
rdqabepoc
rdqabpceo
rdqabpcoe
rdqabpeco
rdqabpeoc
rdqabpoce
rdqabpoec
rdqaebcpo
rdqaebpco
rdqaebpoc
rdqaepbco
rdqaepboc
rdqaepobc
rdqapbceo
rdqapbcoe
rdqapbeco
rdqapbeoc
rdqapboce
rdqapboec
rdqapebco
rdqapeboc
rdqapeobc
rdqapobce
rdqapobec
rdqapoebc
rdqbacepo
rdqbacpeo
rdqbacpoe
rdqbaecpo
rdqbaepco
rdqbaepoc
rdqbapceo
rdqbapcoe
rdqbapeco
rdqbapeoc
rdqbapoce
rdqbapoec
rdqbcaepo
rdqbcapeo
rdqbcapoe
rdqbceapo
rdqbcepao
rdqbcpaeo
rdqbcpaoe
rdqbcpeao
rdqbeacpo
rdqbeapco
rdqbeapoc
rdqbecapo
rdqbecpao
rdqbepaco
rdqbepaoc
rdqbepcao
rdqbpaceo
rdqbpacoe
rdqbpaeco
rdqbpaeoc
rdqbpaoce
rdqbpaoec
rdqbpcaeo
rdqbpcaoe
rdqbpceao
rdqbpeaco
rdqbpeaoc
rdqbpecao
rdqeabcpo
rdqeabpco
rdqeabpoc
rdqeapbco
rdqeapboc
rdqeapobc
rdqebacpo
rdqebapco
rdqebapoc
rdqebcapo
rdqebcpao
rdqebpaco
rdqebpaoc
rdqebpcao
rdqepabco
rdqepaboc
rdqepaobc
rdqepbaco
rdqepbaoc
rdqepbcao
rdqpabceo
rdqpabcoe
rdqpabeco
rdqpabeoc
rdqpaboce
rdqpaboec
rdqpaebco
rdqpaeboc
rdqpaeobc
rdqpaobce
rdqpaobec
rdqpaoebc
rdqpbaceo
rdqpbacoe
rdqpbaeco
rdqpbaeoc
rdqpbaoce
rdqpbaoec
rdqpbcaeo
rdqpbcaoe
rdqpbceao
rdqpbeaco
rdqpbeaoc
rdqpbecao
rdqpeabco
rdqpeaboc
rdqpeaobc
rdqpebaco
rdqpebaoc
rdqpebcao
rqabcdepo
rqabcdpeo
rqabcdpoe
rqabdcepo
rqabdcpeo
rqabdcpoe
rqabdecpo
rqabdepco
rqabdepoc
rqabdpceo
rqabdpcoe
rqabdpeco
rqabdpeoc
rqabdpoce
rqabdpoec
rqadbcepo
rqadbcpeo
rqadbcpoe
rqadbecpo
rqadbepco
rqadbepoc
rqadbpceo
rqadbpcoe
rqadbpeco
rqadbpeoc
rqadbpoce
rqadbpoec
rqadebcpo
rqadebpco
rqadebpoc
rqadepbco
rqadepboc
rqadepobc
rqadpbceo
rqadpbcoe
rqadpbeco
rqadpbeoc
rqadpboce
rqadpboec
rqadpebco
rqadpeboc
rqadpeobc
rqadpobce
rqadpobec
rqadpoebc
rqbacdepo
rqbacdpeo
rqbacdpoe
rqbadcepo
rqbadcpeo
rqbadcpoe
rqbadecpo
rqbadepco
rqbadepoc
rqbadpceo
rqbadpcoe
rqbadpeco
rqbadpeoc
rqbadpoce
rqbadpoec
rqbcadepo
rqbcadpeo
rqbcadpoe
rqbcdaepo
rqbcdapeo
rqbcdapoe
rqbcdeapo
rqbcdepao
rqbcdpaeo
rqbcdpaoe
rqbcdpeao
rqbdacepo
rqbdacpeo
rqbdacpoe
rqbdaecpo
rqbdaepco
rqbdaepoc
rqbdapceo
rqbdapcoe
rqbdapeco
rqbdapeoc
rqbdapoce
rqbdapoec
rqbdcaepo
rqbdcapeo
rqbdcapoe
rqbdceapo
rqbdcepao
rqbdcpaeo
rqbdcpaoe
rqbdcpeao
rqbdeacpo
rqbdeapco
rqbdeapoc
rqbdecapo
rqbdecpao
rqbdepaco
rqbdepaoc
rqbdepcao
rqbdpaceo
rqbdpacoe
rqbdpaeco
rqbdpaeoc
rqbdpaoce
rqbdpaoec
rqbdpcaeo
rqbdpcaoe
rqbdpceao
rqbdpeaco
rqbdpeaoc
rqbdpecao
rqdabcepo
rqdabcpeo
rqdabcpoe
rqdabecpo
rqdabepco
rqdabepoc
rqdabpceo
rqdabpcoe
rqdabpeco
rqdabpeoc
rqdabpoce
rqdabpoec
rqdaebcpo
rqdaebpco
rqdaebpoc
rqdaepbco
rqdaepboc
rqdaepobc
rqdapbceo
rqdapbcoe
rqdapbeco
rqdapbeoc
rqdapboce
rqdapboec
rqdapebco
rqdapeboc
rqdapeobc
rqdapobce
rqdapobec
rqdapoebc
rqdbacepo
rqdbacpeo
rqdbacpoe
rqdbaecpo
rqdbaepco
rqdbaepoc
rqdbapceo
rqdbapcoe
rqdbapeco
rqdbapeoc
rqdbapoce
rqdbapoec
rqdbcaepo
rqdbcapeo
rqdbcapoe
rqdbceapo
rqdbcepao
rqdbcpaeo
rqdbcpaoe
rqdbcpeao
rqdbeacpo
rqdbeapco
rqdbeapoc
rqdbecapo
rqdbecpao
rqdbepaco
rqdbepaoc
rqdbepcao
rqdbpaceo
rqdbpacoe
rqdbpaeco
rqdbpaeoc
rqdbpaoce
rqdbpaoec
rqdbpcaeo
rqdbpcaoe
rqdbpceao
rqdbpeaco
rqdbpeaoc
rqdbpecao
rqdeabcpo
rqdeabpco
rqdeabpoc
rqdeapbco
rqdeapboc
rqdeapobc
rqdebacpo
rqdebapco
rqdebapoc
rqdebcapo
rqdebcpao
rqdebpaco
rqdebpaoc
rqdebpcao
rqdepabco
rqdepaboc
rqdepaobc
rqdepbaco
rqdepbaoc
rqdepbcao
rqdpabceo
rqdpabcoe
rqdpabeco
rqdpabeoc
rqdpaboce
rqdpaboec
rqdpaebco
rqdpaeboc
rqdpaeobc
rqdpaobce
rqdpaobec
rqdpaoebc
rqdpbaceo
rqdpbacoe
rqdpbaeco
rqdpbaeoc
rqdpbaoce
rqdpbaoec
rqdpbcaeo
rqdpbcaoe
rqdpbceao
rqdpbeaco
rqdpbeaoc
rqdpbecao
rqdpeabco
rqdpeaboc
rqdpeaobc
rqdpebaco
rqdpebaoc
rqdpebcao










